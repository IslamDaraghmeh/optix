# Redirect all requests to public folder
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteRule ^$ public/ [L]
    RewriteRule (.*) public/$1 [L]
</IfModule>

# Prevent access to sensitive files and directories
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

# Block access to configuration files
<FilesMatch "\.(env|ini|log|sql|bak|old|sh|conf|json|lock)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Block access to vendor directory
RedirectMatch 403 /vendor/.*$

# Block access to composer files
<FilesMatch "^composer\.(json|lock)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Disable directory browsing
Options -Indexes

# Security Headers
<IfModule mod_headers.c>
    # Prevent XSS attacks
    Header set X-XSS-Protection "1; mode=block"

    # Prevent clickjacking
    Header set X-Frame-Options "SAMEORIGIN"

    # Prevent MIME type sniffing
    Header set X-Content-Type-Options "nosniff"

    # Referrer policy
    Header set Referrer-Policy "strict-origin-when-cross-origin"

    # Remove server information
    Header unset Server
    Header unset X-Powered-By
</IfModule>

# PHP Security Settings
<IfModule mod_php.c>
    php_flag display_errors Off
    php_flag log_errors On
    php_flag expose_php Off
</IfModule>
